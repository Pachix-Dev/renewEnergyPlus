---
import { AddCart } from './AddCart.jsx'
import i18next, { t } from 'i18next'

const translate = t('ecommerce', { returnObjects: true })

const products = [
  {
    id: 1,
    name: 'PASE COMPLETO, ENERGY NIGHT Y VIP AREA',
    name_en: 'FULL PASS, ENERGY NIGHT AND VIP AREA',
    price: 7000, // Precio de fase 1
    originalPrice: 7500, // Precio final
    isPresale: false,
    savings: 1000,
    // Estructura de precios por fases
    pricingPhases: {
      presale: { price: 6500, endDate: '15 de enero, 2026' },
      phase1: { price: 7000, startDate: '01 de febrero, 2026', endDate: '15 de marzo, 2026' },
      phase2: { price: 7500, startDate: '16 de marzo, 2026', endDate: 'hasta la expo' },
      phaseEspecial: { price: 8000, startDate: 'D√≠a del evento', endDate: '31 de enero, 2026' },
    },
    included: [
      '3 d√≠as de conferencias 14, 15 y 16 abril 2026',
      '1 Pase para nuestra "Energy Night"',
      'Acceso a la VIP AREA',
      'Incluye Coffee Break',      
    ],
    included_en: [
      '3 days of conferences 14, 15 and 16 April 2026',
      '1 Pass for our "Energy Night"',
      'Access to the VIP AREA',
      'Includes Coffee Break',      
    ],
  },
  {
    id: 2,
    name: 'ENERGY NIGHT',
    name_en: 'ENERGY NIGHT',
    price: 1100, // Precio de fase 1
    originalPrice: 1200, // Precio final
    isPresale: false,
    savings: 100,
    // Estructura de precios por fases
    pricingPhases: {
      presale: { price: 1000, endDate: '15 de enero, 2026' },
      phase1: { price: 1100, startDate: '16 de enero, 2026', endDate: '15 de marzo, 2026' },
      phase2: { price: 1200, startDate: '16 de marzo', endDate: 'hasta la expo' },
      phaseEspecial: { price: 1300, startDate: 'D√≠a del evento', endDate: 'hasta agotar existencias' },
    },
    included: [
      '1 Entrada para la Energy Night con acceso a bebidas ilimitadas y snack',
      'Acceso martes 14 de abril en Desfilia, Expo Guadalajara',
      'Recepci√≥n 6:15 p.m.',
      'Duraci√≥n 6:30 p.m. - 10:00 p.m.',
    ],
    included_en: [
      '1 Ticket for the Energy Night with unlimited drinks and snacks',
      'Access Tuesday, April 14 at Desfilia, Expo Guadalajara',
      'Reception 6:15 p.m.',
      'Duration 6:30 p.m. - 10:00 p.m.',      
    ],
  },
  {
    id: 3,
    name: 'DAY PASS PREMIUM',
    name_en: 'DAY PASS PREMIUM',
    price: 2500,
    originalPrice: 2600,
    isPresale: false,
    savings: 100,
    requiresDaySelection: true,
    dayLabel_es: 'Selecciona el d√≠a de asistencia',
    dayLabel_en: 'Select your attendance day',
    dayPlaceholder_es: 'Selecciona un d√≠a',
    dayPlaceholder_en: 'Select a day',
    days: [
      {
        value: '2026-04-14',
        label_es: 'Martes 14 de abril',
        label_en: 'Tuesday, April 14',
      },
      {
        value: '2026-04-15',
        label_es: 'Mi√©rcoles 15 de abril',
        label_en: 'Wednesday, April 15',
      },
      {
        value: '2026-04-16',
        label_es: 'Jueves 16 de abril',
        label_en: 'Thursday, April 16',
      },
    ],
    pricingPhases: {
      phase1: { price: 2500, startDate: '01 de febrero, 2026', endDate: '15 de marzo, 2026' },
      phase2: { price: 2600, startDate: '16 de marzo, 2026', endDate: 'hasta la expo' },
    },
    included: [
      'Acceso a conferencias premium por un d√≠a',
      'V√°lido solo para el d√≠a seleccionado',
      'Incluye Coffee Break',
    ],
    included_en: [
      'Premium conference access for one day',
      'Valid only for the selected day',
      'Includes Coffee Break',
    ],
  },
]
---

<div class='mt-16'>
  <!-- Grid de productos -->
  <div class='grid xl:grid-cols-3 gap-8 justify-center max-w-7xl mx-auto'>
    {
      products.map((product, index) => (
        <div 
          class='relative w-full max-w-lg mx-auto'
          data-aos='fade-up'
          data-aos-duration='1000'
          data-aos-delay={index * 200}
        >
          <!-- Badge de m√°s popular (solo para el pase completo) -->
          {product.id === 1 && (
            <div class='absolute -top-4 left-1/3 transform -translate-x-1/2 z-10'>
              <div class='bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-2 rounded-full shadow-lg'>
                <span class='text-xs md>text-sm font-bold uppercase tracking-wider'>üî• {i18next.language === 'es' ? 'M√ÅS POPULAR' : 'MOST POPULAR'}</span>
              </div>
            </div>
          )}

          <!-- Badge de preventa -->
          <div class='absolute -top-3 -right-3 z-10'>
            <div class='bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-4 py-2 rounded-2xl shadow-lg transform rotate-12 animate-pulse'>
              <div class='text-xs font-bold uppercase tracking-wider'>
                {i18next.language === 'es' ? 'FASE 1 ACTIVA' : 'PHASE 1 ACTIVE'}
              </div>
            </div>
          </div>

          <!-- Card principal -->
          <div class={`relative bg-gradient-to-br from-white to-gray-50 rounded-3xl shadow-2xl border overflow-hidden h-full flex flex-col ${product.id === 1 ? 'border-yellow-200 ring-2 ring-yellow-300/50' : 'border-gray-100'}`}>
            
            <!-- Header del card -->
            <div class={`h-32 px-8 py-6 text-center relative overflow-hidden ${product.id === 1 ? 'bg-gradient-to-r from-yellow-400 to-orange-500' : 'bg-gradient-to-r from-[#5E5884] to-[#7B6FA8]'}`}>
              {/* Elementos decorativos */}
              <div class='absolute top-0 left-0 w-full h-full opacity-10'>
                <div class='absolute top-2 right-2 w-16 h-16 border-2 border-white rounded-full animate-spin'></div>
                <div class='absolute bottom-2 left-2 w-12 h-12 border border-white rounded-full animate-bounce'></div>
              </div>
              
              <div class='relative z-10'>
                <h5 class='text-xl lg:text-2xl font-black text-white mb-2 leading-tight'>
                  {i18next.language === 'es' ? product.name : product.name_en}
                </h5>
                {product.id === 1 && (
                  <p class='text-sm text-white/90 font-semibold'>
                    {i18next.language === 'es' ? 'La experiencia completa de RE+ M√©xico' : 'The complete experience of RE+ Mexico'}
                  </p>
                )}
                {product.id === 2 && (
                  <p class='text-sm text-white/90 font-semibold'>
                    {i18next.language === 'es' ? 'La noche m√°s esperada del sector' : 'The most anticipated night in the industry'}
                  </p>
                )}
                {product.id === 3 && (
                  <p class='text-sm text-white/90 font-semibold'>
                    {i18next.language === 'es' ? 'Acceso premium por un d√≠a' : 'Premium access for one day'}
                  </p>
                )}
              </div>
            </div>

            <div class='px-8 py-6 flex flex-col flex-1'>
              {/* <!-- Pricing section con estructura de fases --> */}
              <div class='text-center mb-6'>
                {/* Precio actual */}
                <div class={`rounded-2xl p-5 mb-6 border-2 ${product.id === 1 ? 'bg-gradient-to-r from-green-50 to-emerald-50 border-green-300' : 'bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-300'}`}>
                  <div class='flex items-center justify-center gap-2 mb-3'>
                    <span class={`text-white text-sm font-bold px-4 py-2 rounded-full flex items-center gap-2 ${product.id === 1 ? 'bg-green-500' : 'bg-blue-500'}`}>
                      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      {i18next.language === 'es' ? 'FASE 1 ACTIVA' : 'PHASE 1 ACTIVE'}
                    </span>
                  </div>
                  
                  <div class='flex items-baseline justify-center text-gray-900 mb-3'>
                    <span class='text-2xl font-semibold'>$</span>
                    <span class={`font-black tracking-tight text-4xl ${product.id === 1 ? 'text-green-600' : 'text-blue-600'}`}>
                      {product.pricingPhases.phase1.price.toLocaleString('es-MX')}
                    </span>
                    <span class='text-lg font-normal text-gray-500 ml-1'>MXN</span>
                  </div>
                  
                  <p class={`text-sm font-bold ${product.id === 1 ? 'text-green-800' : 'text-blue-800'}`}>
                    ‚è∞ {i18next.language === 'es' ? 'V√°lido hasta el' : 'Valid until'} 
                    <span class="underline">
                      {product.pricingPhases.phase1.endDate}
                    </span>
                  </p>
                </div>

                {/* Tabla de precios por fases */}
                <div class='bg-gray-50 rounded-2xl p-4 mb-6 border border-gray-200'>
                  
                  <div class='space-y-2'>

                    {/* Precio especial o de preventa */}
                    {/* <div class='flex items-center justify-between p-2 bg-green-100 rounded-lg border-l-4 border-green-500'>
                      <div class="flex-1">
                        <span class='font-bold text-green-800 text-sm'>
                          {i18next.language === 'es' ? 'PRECIO ESPECIAL' : 'SPECIAL PRICE'}
                        </span>
                        <p class="text-xs text-green-700">
                          {i18next.language === 'es' ? 'Hasta el 15 enero' : 'Until Jan 15'}
                        </p>
                      </div>
                      <span class='text-lg font-black text-green-600'>
                        ${product.pricingPhases.presale.price.toLocaleString('es-MX')}
                      </span>
                    </div> */}

                    {/* Fase 1 */}
                    <div class='flex items-center justify-between p-2 bg-yellow-100 rounded-lg border-l-4 border-yellow-500'>
                      <div class="flex-1">
                        <span class='font-bold text-yellow-800 text-sm'>
                          {i18next.language === 'es' ? 'FASE 1' : 'PHASE 1'}
                        </span>
                        <p class="text-xs text-yellow-700">
                          {
                            product.id === 1 
                              ? (i18next.language === 'es' ? '01 feb - 15 mar' : 'Feb 01 - Mar 15')
                              : product.id === 2
                                ? (i18next.language === 'es' ? '16 ene - 15 mar' : 'Jan 16 - Mar 15')
                                : (i18next.language === 'es' ? '01 feb - 15 mar' : 'Feb 01 - Mar 15')
                          }
                        </p>
                      </div>
                      <span class='text-lg font-bold text-yellow-700'>
                        ${product.pricingPhases.phase1.price.toLocaleString('es-MX')}
                      </span>
                    </div>

                    {/* Fase 2 */}
                    <div class='flex items-center justify-between p-2 bg-red-100 rounded-lg border-l-4 border-red-500'>
                      <div class="flex-1">
                        <span class='font-bold text-red-800 text-sm'>
                          {i18next.language === 'es' ? 'FASE 2' : 'PHASE 2'}
                        </span>
                        <p class="text-xs text-red-700">
                          {i18next.language === 'es' ? '16 mar - expo' : 'Mar 16 - expo'}
                        </p>
                      </div>
                      <span class='text-lg font-bold text-red-700'>
                        ${product.pricingPhases.phase2.price.toLocaleString('es-MX')}
                      </span>
                    </div>
                  </div>

                  {/* Ahorro destacado */}
                  <div class='mt-3 p-2 bg-gradient-to-r from-orange-50 to-red-50 rounded-lg border border-orange-200'>
                    <div class='text-center'>
                      <span class='bg-gradient-to-r from-orange-500 to-red-500 text-white text-xs font-bold px-3 py-1 rounded-full'>
                        {i18next.language === 'es' ? '¬°Ahorra hasta' : 'Save up to'} ${(product.pricingPhases.phase2.price - product.pricingPhases.phase1.price).toLocaleString('es-MX')} MXN{i18next.language === 'es' ? '!' : '!'}
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              {/* Lista de beneficios */}
              <ul role='list' class='space-y-3 mb-6 flex-grow'>
                {(i18next.language === 'es' ? product.included : product.included_en).map((list) => (
                  <li class='flex items-start gap-3'>
                    <div class={`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center mt-0.5 ${product.id === 1 ? 'bg-gradient-to-r from-yellow-400 to-orange-500' : 'bg-gradient-to-r from-[#5E5884] to-[#7B6FA8]'}`}>
                      <svg
                        class='w-3 h-3 text-white'
                        aria-hidden='true'
                        xmlns='http://www.w3.org/2000/svg'
                        fill='currentColor'
                        viewBox='0 0 20 20'
                      >
                        <path d='M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z' />
                      </svg>
                    </div>
                    <span class='text-gray-700 font-medium leading-tight flex-1 text-sm'>
                      {list}
                    </span>
                  </li>
                ))}
              </ul>

              {/* Bot√≥n de ver programa premium para el pase completo y day pass */}
              {(product.id === 1 || product.id === 3) && (
                <div class='mx-auto mb-4'>
                  <a
                    href='/programa-premium'
                    class='inline-flex items-center justify-center px-6 py-3 rounded-xl font-bold text-white bg-gradient-to-r from-[#5E5884] to-[#7B6FA8] hover:opacity-90 transition-opacity'
                  >
                    {i18next.language === 'es' ? 'Ver programa premium' : 'See premium program'}
                  </a>
                </div>
              )}

              {/* Bot√≥n de compra */}
              <div class='mx-auto mb-4'>
                <AddCart item={product} translate={translate} language={i18next.language} client:only="react" />
              </div>
            </div>

            {/* Footer con informaci√≥n adicional */}
            <div class='bg-gradient-to-r from-blue-50/80 to-cyan-50/80 px-6 py-4 border-t-2 border-blue-200'>
              <div class='text-center'>
                <div class="flex items-center justify-center gap-2 mb-1">
                  <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></div>
                  <p class='text-sm font-bold text-blue-800'>
                    {i18next.language === 'es' 
                      ? '¬°Estamos en Fase 1!' 
                      : 'We are in Phase 1!'}
                  </p>
                </div>
                <p class='text-xs text-blue-700 font-semibold'>
                  {i18next.language === 'es' 
                    ? 'El precio aumentar√° en la fase siguiente' 
                    : 'Price will increase in the next phase'}
                </p>
              </div>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</div>